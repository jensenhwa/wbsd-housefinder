<!DOCTYPE html>
<html lang="en">
<head>
    <title>Properties Within Our District</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: Roboto,sans-serif;
        }

        ul {
            margin-bottom: 0;
            overflow: hidden;
        }

        #map {
            min-height: 400px;
            clear: both;
        }

        #autocomplete {
            top: 0;
            left: 0;
            width: 470px;
        }

        #address td {
            font-size: 10pt;
        }

        #locationField {
            position: relative;
            margin-bottom: 2px;
            z-index: 1;
        }

        #addressInput {
            float: left;
            margin-right: 20px;
        }

        #outputLeft {
            text-align: center;
            align-self: center;
        }

        #outputLeftContainer {
            display: flex;
            height: 150px;
            justify-content: center;
        }

        #outputRight {
            align-self: center;
        }

        #outputRightContainer {
            display: flex;
            height: 171px;
        }

        #result {
            margin-top: 0;
        }

        .alert {
            vertical-align: middle;
        }

        #reset {
            visibility: hidden;
        }
    </style>
</head>

<body>
<div id="addressInput">
    <div id="locationField">
        <input id="autocomplete" placeholder="Enter your address" onFocus="geolocate()" type="text">
        <button id="reset" type="reset" onclick="restart()">Start Over</button>
    </div>
    <div id="outputLeftContainer">
        <div id="outputLeft"></div>
    </div>
</div>
<div id="outputRightContainer">
    <div id="outputRight"><img src="alert.png" alt="alert" width="50" class="alert">Please enable Javascript in your
        browser.
    </div>
</div>

<div id="map"></div>
<script>
    /**
     * Determines whether an address falls within the boundaries of the West Bloomfield School District.
     *
     * @author Jensen Hwa
     * @version 2015.11.2
     */

    var map, districtBoundary, autocomplete, mapCheck, dbCheck;
    var marker;
    var mobile;
    var mapCenter = {lat: 42.5719205, lng: -83.3814459};
    var mapZoom = 13;
    var outputRight = document.getElementById('outputRight');
    var outputLeft = document.getElementById('outputLeft');
    var componentForm = [
        "street_number",
        "route",
        "postal_code"
    ];
    var parsedAddress = {};

    // Clear the address text input.
    function restart() {
        document.getElementById('autocomplete').value = "";
        begin();
    }

    //  Reset the map and output.
    function begin() {
        outputLeft.innerHTML = "";
        outputRight.innerHTML = 'Enter your address to continue.<br>The address you provide will be checked to see if it falls within our boundaries as indicated on the map below, and if it is in our database.';
        document.getElementById('reset').style.visibility = 'hidden';
        marker.setMap(null);
        map.panTo(mapCenter);
        map.setZoom(mapZoom);
    }

    // noinspection JSUnusedGlobalSymbols
    function initialize() {
        // Determine whether the window is viewed in a narrow mobile format, and set widths and heights appropriately.
        outputLeft.innerHTML = "";
        outputRight.innerHTML = 'Enter your address to continue.<br>The address you provide will be checked to see if it falls within our boundaries as indicated on the map below, and if it is in our database.';
        document.getElementById("autocomplete").style.maxWidth = window.innerWidth - 4 + "px";
        document.getElementById("locationField").style.width = document.getElementById("autocomplete").offsetWidth + "px";
        if (document.getElementById("addressInput").offsetHeight > document.getElementById("outputRight").offsetHeight) {
            document.getElementById("map").style.height = window.innerHeight - document.getElementById("addressInput").offsetHeight + "px";
            mobile = false;
        } else {
            document.getElementById('outputRightContainer').style.clear = "both";
            document.getElementById("map").style.height = (window.innerHeight - document.getElementById("addressInput").offsetHeight - document.getElementById("outputRightContainer").offsetHeight) + "px";
            mapZoom = 12;
            mobile = true;
        }
        marker = new google.maps.Marker;
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: mapZoom,
            center: mapCenter,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        // District boundaries from 2021 census data
        var boundaryCoords = [
            {lat: 42.606383, lng: -83.422987},
            {lat: 42.606603, lng: -83.423001},
            {lat: 42.606713, lng: -83.423008},
            {lat: 42.606779, lng: -83.422633},
            {lat: 42.607147, lng: -83.422384},
            {lat: 42.606895, lng: -83.421969},
            {lat: 42.606743, lng: -83.421679},
            {lat: 42.606673, lng: -83.421536},
            {lat: 42.606801, lng: -83.420272},
            {lat: 42.606768, lng: -83.419539},
            {lat: 42.606768, lng: -83.418444},
            {lat: 42.607067, lng: -83.413044},
            {lat: 42.607095, lng: -83.411824},
            {lat: 42.607112, lng: -83.411254},
            {lat: 42.607149, lng: -83.409995},
            {lat: 42.607161, lng: -83.409607},
            {lat: 42.607189, lng: -83.408389},
            {lat: 42.6072, lng: -83.407451},
            {lat: 42.607233, lng: -83.406161},
            {lat: 42.607254, lng: -83.405482},
            {lat: 42.607305, lng: -83.403774},
            {lat: 42.607322, lng: -83.403179},
            {lat: 42.607351, lng: -83.402389},
            {lat: 42.607398, lng: -83.400935},
            {lat: 42.607415, lng: -83.400369},
            {lat: 42.607494, lng: -83.398257},
            {lat: 42.610142, lng: -83.398394},
            {lat: 42.610833, lng: -83.39844},
            {lat: 42.611492, lng: -83.398469},
            {lat: 42.611851, lng: -83.398501},
            {lat: 42.612998, lng: -83.398558},
            {lat: 42.614729, lng: -83.398654},
            {lat: 42.616244, lng: -83.398734},
            {lat: 42.616286, lng: -83.398455},
            {lat: 42.616296, lng: -83.396698},
            {lat: 42.616343, lng: -83.395503},
            {lat: 42.616388, lng: -83.39345},
            {lat: 42.616429, lng: -83.392576},
            {lat: 42.61644, lng: -83.392346},
            {lat: 42.616479, lng: -83.391016},
            {lat: 42.616497, lng: -83.390607},
            {lat: 42.616517, lng: -83.390217},
            {lat: 42.616519, lng: -83.389959},
            {lat: 42.61652, lng: -83.388823},
            {lat: 42.616529, lng: -83.388595},
            {lat: 42.61657, lng: -83.387612},
            {lat: 42.616604, lng: -83.386198},
            {lat: 42.61658, lng: -83.385141},
            {lat: 42.616597, lng: -83.383788},
            {lat: 42.616595, lng: -83.38303},
            {lat: 42.616584, lng: -83.382514},
            {lat: 42.616573, lng: -83.381965},
            {lat: 42.616582, lng: -83.381299},
            {lat: 42.61655, lng: -83.381248},
            {lat: 42.61655, lng: -83.380877},
            {lat: 42.616787, lng: -83.380851},
            {lat: 42.616585, lng: -83.379509},
            {lat: 42.616568, lng: -83.377806},
            {lat: 42.61651, lng: -83.376932},
            {lat: 42.616325, lng: -83.37679},
            {lat: 42.616402, lng: -83.376619},
            {lat: 42.616894, lng: -83.375533},
            {lat: 42.616739, lng: -83.375135},
            {lat: 42.615903, lng: -83.375835},
            {lat: 42.614848, lng: -83.375603},
            {lat: 42.613912, lng: -83.374548},
            {lat: 42.613991, lng: -83.373756},
            {lat: 42.614035, lng: -83.373324},
            {lat: 42.613806, lng: -83.373413},
            {lat: 42.613667, lng: -83.372607},
            {lat: 42.613382, lng: -83.372624},
            {lat: 42.611804, lng: -83.372643},
            {lat: 42.611738, lng: -83.369702},
            {lat: 42.611711, lng: -83.360081},
            {lat: 42.613712, lng: -83.360065},
            {lat: 42.615007, lng: -83.360044},
            {lat: 42.615006, lng: -83.359123},
            {lat: 42.61502, lng: -83.357459},
            {lat: 42.616504, lng: -83.357498},
            {lat: 42.617165, lng: -83.357509},
            {lat: 42.617305, lng: -83.357077},
            {lat: 42.617327, lng: -83.35701},
            {lat: 42.617394, lng: -83.356949},
            {lat: 42.617399, lng: -83.356785},
            {lat: 42.617444, lng: -83.35552},
            {lat: 42.617471, lng: -83.354425},
            {lat: 42.617511, lng: -83.352894},
            {lat: 42.61754, lng: -83.351959},
            {lat: 42.617561, lng: -83.35121},
            {lat: 42.617566, lng: -83.351038},
            {lat: 42.617569, lng: -83.350873},
            {lat: 42.617571, lng: -83.350732},
            {lat: 42.617602, lng: -83.350414},
            {lat: 42.617603, lng: -83.350382},
            {lat: 42.617627, lng: -83.349773},
            {lat: 42.617632, lng: -83.349643},
            {lat: 42.617664, lng: -83.348692},
            {lat: 42.617693, lng: -83.347893},
            {lat: 42.617695, lng: -83.347864},
            {lat: 42.617712, lng: -83.347236},
            {lat: 42.617725, lng: -83.346899},
            {lat: 42.617765, lng: -83.345914},
            {lat: 42.617774, lng: -83.345597},
            {lat: 42.617806, lng: -83.344546},
            {lat: 42.61782, lng: -83.344114},
            {lat: 42.617834, lng: -83.343609},
            {lat: 42.617885, lng: -83.342082},
            {lat: 42.617917, lng: -83.341131},
            {lat: 42.617965, lng: -83.339686},
            {lat: 42.617894, lng: -83.339678},
            {lat: 42.617942, lng: -83.337419},
            {lat: 42.613995, lng: -83.336837},
            {lat: 42.613887, lng: -83.336838},
            {lat: 42.613089, lng: -83.336845},
            {lat: 42.61092, lng: -83.336906},
            {lat: 42.608474, lng: -83.336809},
            {lat: 42.608597, lng: -83.336484},
            {lat: 42.608162, lng: -83.336174},
            {lat: 42.607288, lng: -83.336113},
            {lat: 42.607292, lng: -83.335685},
            {lat: 42.60597, lng: -83.337198},
            {lat: 42.605728, lng: -83.337481},
            {lat: 42.605488, lng: -83.337763},
            {lat: 42.604944, lng: -83.338303},
            {lat: 42.604487, lng: -83.338814},
            {lat: 42.604336, lng: -83.338985},
            {lat: 42.604297, lng: -83.339028},
            {lat: 42.604276, lng: -83.339051},
            {lat: 42.604263, lng: -83.339065},
            {lat: 42.604216, lng: -83.339118},
            {lat: 42.603894, lng: -83.339119},
            {lat: 42.603539, lng: -83.33912},
            {lat: 42.603043, lng: -83.339121},
            {lat: 42.602873, lng: -83.339126},
            {lat: 42.602588, lng: -83.33912},
            {lat: 42.601822, lng: -83.339084},
            {lat: 42.601739, lng: -83.341917},
            {lat: 42.601257, lng: -83.342469},
            {lat: 42.600879, lng: -83.342968},
            {lat: 42.600492, lng: -83.343485},
            {lat: 42.600412, lng: -83.3436},
            {lat: 42.599919, lng: -83.343574},
            {lat: 42.595799, lng: -83.343391},
            {lat: 42.595658, lng: -83.343531},
            {lat: 42.59545, lng: -83.343704},
            {lat: 42.595376, lng: -83.343712},
            {lat: 42.595238, lng: -83.343674},
            {lat: 42.595097, lng: -83.343491},
            {lat: 42.595077, lng: -83.34336},
            {lat: 42.594382, lng: -83.34334},
            {lat: 42.594369, lng: -83.343654},
            {lat: 42.594307, lng: -83.345078},
            {lat: 42.594287, lng: -83.345518},
            {lat: 42.594563, lng: -83.346261},
            {lat: 42.594788, lng: -83.347237},
            {lat: 42.595088, lng: -83.347206},
            {lat: 42.595343, lng: -83.349872},
            {lat: 42.595047, lng: -83.349926},
            {lat: 42.594935, lng: -83.349947},
            {lat: 42.594538, lng: -83.350018},
            {lat: 42.594242, lng: -83.350084},
            {lat: 42.594091, lng: -83.350134},
            {lat: 42.593913, lng: -83.350194},
            {lat: 42.593697, lng: -83.350286},
            {lat: 42.593488, lng: -83.350421},
            {lat: 42.593469, lng: -83.350434},
            {lat: 42.593211, lng: -83.35026},
            {lat: 42.593132, lng: -83.350416},
            {lat: 42.593114, lng: -83.350432},
            {lat: 42.59306, lng: -83.350479},
            {lat: 42.593001, lng: -83.350507},
            {lat: 42.592953, lng: -83.35053},
            {lat: 42.592924, lng: -83.350539},
            {lat: 42.5929, lng: -83.350543},
            {lat: 42.592849, lng: -83.350548},
            {lat: 42.5928, lng: -83.350554},
            {lat: 42.592755, lng: -83.350572},
            {lat: 42.592645, lng: -83.350637},
            {lat: 42.592665, lng: -83.351003},
            {lat: 42.592298, lng: -83.351266},
            {lat: 42.591974, lng: -83.351464},
            {lat: 42.591539, lng: -83.351684},
            {lat: 42.591135, lng: -83.351853},
            {lat: 42.590804, lng: -83.351969},
            {lat: 42.590534, lng: -83.352078},
            {lat: 42.590347, lng: -83.352173},
            {lat: 42.590136, lng: -83.352375},
            {lat: 42.589763, lng: -83.352857},
            {lat: 42.589599, lng: -83.353007},
            {lat: 42.589446, lng: -83.353059},
            {lat: 42.589296, lng: -83.353039},
            {lat: 42.589289, lng: -83.353567},
            {lat: 42.589274, lng: -83.353667},
            {lat: 42.589268, lng: -83.353714},
            {lat: 42.589236, lng: -83.35375},
            {lat: 42.589135, lng: -83.353814},
            {lat: 42.588578, lng: -83.354108},
            {lat: 42.588445, lng: -83.354079},
            {lat: 42.588412, lng: -83.354039},
            {lat: 42.587909, lng: -83.354513},
            {lat: 42.587855, lng: -83.354603},
            {lat: 42.587767, lng: -83.354753},
            {lat: 42.587617, lng: -83.354916},
            {lat: 42.587423, lng: -83.355099},
            {lat: 42.58661, lng: -83.355459},
            {lat: 42.586492, lng: -83.355742},
            {lat: 42.586474, lng: -83.35579},
            {lat: 42.586422, lng: -83.355929},
            {lat: 42.586307, lng: -83.356141},
            {lat: 42.586099, lng: -83.356389},
            {lat: 42.586165, lng: -83.356583},
            {lat: 42.586107, lng: -83.356608},
            {lat: 42.586138, lng: -83.356839},
            {lat: 42.586883, lng: -83.362173},
            {lat: 42.581989, lng: -83.362277},
            {lat: 42.581368, lng: -83.36171},
            {lat: 42.579879, lng: -83.362366},
            {lat: 42.57931, lng: -83.362419},
            {lat: 42.579044, lng: -83.362351},
            {lat: 42.579044, lng: -83.362328},
            {lat: 42.579054, lng: -83.360224},
            {lat: 42.579056, lng: -83.359688},
            {lat: 42.579594, lng: -83.359245},
            {lat: 42.57956, lng: -83.359168},
            {lat: 42.579243, lng: -83.358452},
            {lat: 42.578983, lng: -83.358345},
            {lat: 42.578966, lng: -83.357652},
            {lat: 42.578765, lng: -83.357182},
            {lat: 42.578697, lng: -83.35725},
            {lat: 42.578582, lng: -83.357405},
            {lat: 42.578537, lng: -83.357529},
            {lat: 42.57814, lng: -83.357216},
            {lat: 42.577989, lng: -83.357625},
            {lat: 42.577487, lng: -83.357479},
            {lat: 42.577158, lng: -83.357399},
            {lat: 42.576862, lng: -83.357352},
            {lat: 42.576473, lng: -83.35737},
            {lat: 42.575596, lng: -83.357454},
            {lat: 42.575446, lng: -83.357468},
            {lat: 42.574957, lng: -83.357452},
            {lat: 42.574367, lng: -83.357361},
            {lat: 42.573733, lng: -83.357267},
            {lat: 42.573443, lng: -83.357248},
            {lat: 42.573188, lng: -83.357166},
            {lat: 42.573062, lng: -83.357047},
            {lat: 42.572999, lng: -83.356968},
            {lat: 42.572989, lng: -83.356991},
            {lat: 42.57283, lng: -83.35716},
            {lat: 42.572573, lng: -83.357231},
            {lat: 42.572201, lng: -83.357225},
            {lat: 42.5717, lng: -83.357205},
            {lat: 42.571187, lng: -83.357191},
            {lat: 42.570842, lng: -83.357247},
            {lat: 42.569661, lng: -83.357462},
            {lat: 42.568829, lng: -83.357433},
            {lat: 42.56858, lng: -83.357398},
            {lat: 42.56656, lng: -83.357162},
            {lat: 42.566555, lng: -83.356619},
            {lat: 42.566545, lng: -83.353629},
            {lat: 42.566547, lng: -83.353104},
            {lat: 42.566525, lng: -83.349424},
            {lat: 42.566551, lng: -83.349413},
            {lat: 42.566551, lng: -83.348595},
            {lat: 42.566551, lng: -83.348138},
            {lat: 42.566534, lng: -83.348126},
            {lat: 42.566532, lng: -83.347458},
            {lat: 42.565411, lng: -83.347373},
            {lat: 42.565105, lng: -83.347383},
            {lat: 42.564999, lng: -83.347385},
            {lat: 42.56443, lng: -83.347394},
            {lat: 42.563615, lng: -83.347408},
            {lat: 42.563412, lng: -83.347401},
            {lat: 42.562244, lng: -83.347389},
            {lat: 42.559254, lng: -83.347206},
            {lat: 42.557863, lng: -83.347237},
            {lat: 42.55788, lng: -83.346683},
            {lat: 42.557903, lng: -83.345998},
            {lat: 42.557911, lng: -83.34562},
            {lat: 42.55792, lng: -83.34518},
            {lat: 42.557869, lng: -83.344831},
            {lat: 42.557845, lng: -83.344665},
            {lat: 42.557665, lng: -83.344107},
            {lat: 42.557349, lng: -83.343312},
            {lat: 42.557224, lng: -83.342989},
            {lat: 42.556716, lng: -83.341676},
            {lat: 42.55588, lng: -83.34164},
            {lat: 42.555219, lng: -83.341601},
            {lat: 42.554597, lng: -83.341577},
            {lat: 42.552913, lng: -83.341497},
            {lat: 42.552159, lng: -83.341454},
            {lat: 42.551807, lng: -83.341449},
            {lat: 42.551663, lng: -83.341447},
            {lat: 42.551066, lng: -83.34142},
            {lat: 42.550279, lng: -83.34137},
            {lat: 42.549733, lng: -83.341351},
            {lat: 42.547314, lng: -83.341244},
            {lat: 42.54608, lng: -83.341224},
            {lat: 42.545345, lng: -83.341199},
            {lat: 42.543577, lng: -83.341151},
            {lat: 42.543478, lng: -83.341138},
            {lat: 42.543375, lng: -83.34112},
            {lat: 42.543059, lng: -83.341106},
            {lat: 42.54208, lng: -83.34105},
            {lat: 42.5417, lng: -83.341039},
            {lat: 42.541293, lng: -83.34101},
            {lat: 42.540866, lng: -83.340996},
            {lat: 42.540183, lng: -83.340956},
            {lat: 42.53999, lng: -83.34095},
            {lat: 42.539727, lng: -83.340932},
            {lat: 42.539515, lng: -83.340918},
            {lat: 42.538862, lng: -83.340894},
            {lat: 42.538451, lng: -83.340868},
            {lat: 42.538046, lng: -83.34086},
            {lat: 42.537211, lng: -83.340827},
            {lat: 42.536162, lng: -83.340774},
            {lat: 42.536048, lng: -83.346621},
            {lat: 42.535673, lng: -83.346603},
            {lat: 42.535662, lng: -83.347243},
            {lat: 42.535988, lng: -83.34725},
            {lat: 42.535985, lng: -83.347273},
            {lat: 42.535904, lng: -83.347969},
            {lat: 42.535835, lng: -83.348599},
            {lat: 42.535793, lng: -83.349215},
            {lat: 42.535918, lng: -83.349249},
            {lat: 42.535918, lng: -83.350047},
            {lat: 42.535732, lng: -83.354841},
            {lat: 42.535725, lng: -83.355363},
            {lat: 42.535693, lng: -83.357365},
            {lat: 42.535693, lng: -83.357396},
            {lat: 42.535665, lng: -83.360199},
            {lat: 42.535662, lng: -83.360416},
            {lat: 42.535384, lng: -83.360407},
            {lat: 42.534503, lng: -83.360371},
            {lat: 42.533601, lng: -83.360333},
            {lat: 42.533243, lng: -83.360318},
            {lat: 42.53318, lng: -83.361778},
            {lat: 42.533193, lng: -83.36181},
            {lat: 42.533062, lng: -83.365843},
            {lat: 42.52824, lng: -83.365579},
            {lat: 42.52824, lng: -83.365597},
            {lat: 42.528229, lng: -83.365965},
            {lat: 42.528222, lng: -83.366332},
            {lat: 42.528219, lng: -83.366487},
            {lat: 42.528188, lng: -83.367472},
            {lat: 42.528139, lng: -83.369127},
            {lat: 42.528126, lng: -83.369527},
            {lat: 42.528081, lng: -83.370992},
            {lat: 42.528052, lng: -83.371666},
            {lat: 42.528033, lng: -83.372313},
            {lat: 42.527994, lng: -83.373713},
            {lat: 42.52796, lng: -83.375005},
            {lat: 42.527903, lng: -83.377509},
            {lat: 42.527888, lng: -83.378491},
            {lat: 42.52788, lng: -83.378937},
            {lat: 42.527875, lng: -83.379078},
            {lat: 42.5279, lng: -83.379222},
            {lat: 42.528028, lng: -83.379434},
            {lat: 42.528075, lng: -83.379552},
            {lat: 42.528103, lng: -83.379652},
            {lat: 42.528106, lng: -83.379728},
            {lat: 42.528077, lng: -83.379896},
            {lat: 42.528046, lng: -83.379956},
            {lat: 42.527984, lng: -83.380079},
            {lat: 42.527921, lng: -83.380261},
            {lat: 42.527888, lng: -83.380447},
            {lat: 42.527858, lng: -83.380703},
            {lat: 42.527808, lng: -83.381122},
            {lat: 42.527779, lng: -83.38203},
            {lat: 42.527745, lng: -83.383049},
            {lat: 42.527702, lng: -83.384393},
            {lat: 42.527697, lng: -83.384585},
            {lat: 42.528194, lng: -83.384537},
            {lat: 42.528304, lng: -83.384535},
            {lat: 42.528482, lng: -83.38454},
            {lat: 42.529005, lng: -83.38454},
            {lat: 42.531017, lng: -83.384551},
            {lat: 42.531403, lng: -83.384532},
            {lat: 42.533835, lng: -83.384799},
            {lat: 42.534954, lng: -83.384915},
            {lat: 42.534882, lng: -83.388205},
            {lat: 42.534683, lng: -83.394676},
            {lat: 42.537991, lng: -83.394788},
            {lat: 42.537811, lng: -83.399764},
            {lat: 42.540654, lng: -83.399916},
            {lat: 42.540799, lng: -83.399975},
            {lat: 42.541132, lng: -83.40001},
            {lat: 42.541348, lng: -83.400046},
            {lat: 42.541486, lng: -83.40013},
            {lat: 42.541607, lng: -83.40023},
            {lat: 42.541681, lng: -83.400325},
            {lat: 42.541724, lng: -83.400347},
            {lat: 42.541763, lng: -83.400367},
            {lat: 42.541871, lng: -83.400367},
            {lat: 42.541967, lng: -83.400334},
            {lat: 42.542005, lng: -83.400291},
            {lat: 42.542053, lng: -83.400238},
            {lat: 42.542149, lng: -83.400138},
            {lat: 42.542277, lng: -83.400052},
            {lat: 42.54333, lng: -83.400068},
            {lat: 42.54361, lng: -83.400057},
            {lat: 42.544293, lng: -83.400085},
            {lat: 42.544826, lng: -83.400107},
            {lat: 42.545438, lng: -83.400132},
            {lat: 42.546548, lng: -83.400195},
            {lat: 42.547138, lng: -83.400228},
            {lat: 42.54907, lng: -83.400332},
            {lat: 42.549128, lng: -83.398845},
            {lat: 42.549234, lng: -83.395591},
            {lat: 42.549431, lng: -83.395394},
            {lat: 42.552848, lng: -83.395534},
            {lat: 42.554193, lng: -83.395623},
            {lat: 42.555688, lng: -83.39572},
            {lat: 42.556495, lng: -83.395774},
            {lat: 42.56068, lng: -83.395965},
            {lat: 42.560665, lng: -83.396111},
            {lat: 42.561175, lng: -83.396124},
            {lat: 42.561185, lng: -83.395989},
            {lat: 42.561203, lng: -83.395989},
            {lat: 42.561661, lng: -83.396011},
            {lat: 42.561691, lng: -83.395508},
            {lat: 42.561932, lng: -83.391743},
            {lat: 42.562014, lng: -83.39037},
            {lat: 42.562038, lng: -83.390051},
            {lat: 42.562187, lng: -83.387368},
            {lat: 42.562252, lng: -83.386177},
            {lat: 42.564064, lng: -83.386261},
            {lat: 42.564087, lng: -83.385608},
            {lat: 42.564141, lng: -83.384119},
            {lat: 42.564095, lng: -83.383869},
            {lat: 42.564213, lng: -83.382088},
            {lat: 42.565527, lng: -83.382148},
            {lat: 42.565636, lng: -83.382156},
            {lat: 42.565922, lng: -83.381439},
            {lat: 42.567624, lng: -83.381489},
            {lat: 42.569313, lng: -83.38158},
            {lat: 42.569324, lng: -83.381481},
            {lat: 42.569473, lng: -83.381504},
            {lat: 42.571515, lng: -83.381607},
            {lat: 42.571592, lng: -83.381701},
            {lat: 42.57159, lng: -83.382097},
            {lat: 42.571884, lng: -83.382099},
            {lat: 42.572711, lng: -83.382145},
            {lat: 42.572774, lng: -83.381955},
            {lat: 42.572793, lng: -83.381836},
            {lat: 42.572978, lng: -83.381879},
            {lat: 42.572972, lng: -83.381954},
            {lat: 42.573, lng: -83.381949},
            {lat: 42.57302, lng: -83.381938},
            {lat: 42.573034, lng: -83.381905},
            {lat: 42.573053, lng: -83.381887},
            {lat: 42.573067, lng: -83.381926},
            {lat: 42.573105, lng: -83.381929},
            {lat: 42.57312, lng: -83.381944},
            {lat: 42.573145, lng: -83.382025},
            {lat: 42.573213, lng: -83.382005},
            {lat: 42.573309, lng: -83.382011},
            {lat: 42.573334, lng: -83.382018},
            {lat: 42.573444, lng: -83.382102},
            {lat: 42.573476, lng: -83.38212},
            {lat: 42.573532, lng: -83.382197},
            {lat: 42.573563, lng: -83.382208},
            {lat: 42.573624, lng: -83.38221},
            {lat: 42.573648, lng: -83.382243},
            {lat: 42.57365, lng: -83.382269},
            {lat: 42.573689, lng: -83.382298},
            {lat: 42.573761, lng: -83.38232},
            {lat: 42.573782, lng: -83.382342},
            {lat: 42.573792, lng: -83.382367},
            {lat: 42.573795, lng: -83.382415},
            {lat: 42.573801, lng: -83.382438},
            {lat: 42.57382, lng: -83.382434},
            {lat: 42.573858, lng: -83.382396},
            {lat: 42.57391, lng: -83.382384},
            {lat: 42.57393, lng: -83.382371},
            {lat: 42.573922, lng: -83.382339},
            {lat: 42.573938, lng: -83.382271},
            {lat: 42.573952, lng: -83.382235},
            {lat: 42.574198, lng: -83.381908},
            {lat: 42.574475, lng: -83.381709},
            {lat: 42.574562, lng: -83.381656},
            {lat: 42.574787, lng: -83.382191},
            {lat: 42.574881, lng: -83.38219},
            {lat: 42.574909, lng: -83.382149},
            {lat: 42.575707, lng: -83.382179},
            {lat: 42.575912, lng: -83.382156},
            {lat: 42.575896, lng: -83.382459},
            {lat: 42.576127, lng: -83.391476},
            {lat: 42.57537, lng: -83.39224},
            {lat: 42.575222, lng: -83.392372},
            {lat: 42.574814, lng: -83.393196},
            {lat: 42.574589, lng: -83.397614},
            {lat: 42.574608, lng: -83.401566},
            {lat: 42.574441, lng: -83.408787},
            {lat: 42.57373, lng: -83.414383},
            {lat: 42.573513, lng: -83.415222},
            {lat: 42.573563, lng: -83.415512},
            {lat: 42.573882, lng: -83.415843},
            {lat: 42.574089, lng: -83.416058},
            {lat: 42.574122, lng: -83.416075},
            {lat: 42.574786, lng: -83.416419},
            {lat: 42.574892, lng: -83.416454},
            {lat: 42.574986, lng: -83.416566},
            {lat: 42.575214, lng: -83.416739},
            {lat: 42.575168, lng: -83.41687},
            {lat: 42.575095, lng: -83.417138},
            {lat: 42.575073, lng: -83.417216},
            {lat: 42.574991, lng: -83.41752},
            {lat: 42.576042, lng: -83.417558},
            {lat: 42.576047, lng: -83.417597},
            {lat: 42.576261, lng: -83.417612},
            {lat: 42.576272, lng: -83.41758},
            {lat: 42.577027, lng: -83.416988},
            {lat: 42.577053, lng: -83.417002},
            {lat: 42.577728, lng: -83.41812},
            {lat: 42.578028, lng: -83.418501},
            {lat: 42.579069, lng: -83.420547},
            {lat: 42.579058, lng: -83.420942},
            {lat: 42.579053, lng: -83.421154},
            {lat: 42.579157, lng: -83.421366},
            {lat: 42.579195, lng: -83.421513},
            {lat: 42.579872, lng: -83.421495},
            {lat: 42.579987, lng: -83.421505},
            {lat: 42.581734, lng: -83.421621},
            {lat: 42.58205, lng: -83.421635},
            {lat: 42.58445, lng: -83.421487},
            {lat: 42.584868, lng: -83.421702},
            {lat: 42.585105, lng: -83.414437},
            {lat: 42.58538, lng: -83.414468},
            {lat: 42.585846, lng: -83.414504},
            {lat: 42.588729, lng: -83.414729},
            {lat: 42.588714, lng: -83.41519},
            {lat: 42.58867, lng: -83.416545},
            {lat: 42.588669, lng: -83.416869},
            {lat: 42.588679, lng: -83.417236},
            {lat: 42.588714, lng: -83.417531},
            {lat: 42.588765, lng: -83.417851},
            {lat: 42.588899, lng: -83.418297},
            {lat: 42.58926, lng: -83.4193},
            {lat: 42.589557, lng: -83.420077},
            {lat: 42.589692, lng: -83.420449},
            {lat: 42.589898, lng: -83.420983},
            {lat: 42.590064, lng: -83.421451},
            {lat: 42.590238, lng: -83.421908},
            {lat: 42.590575, lng: -83.42197},
            {lat: 42.590611, lng: -83.422084},
            {lat: 42.59084, lng: -83.422335},
            {lat: 42.591434, lng: -83.422367},
            {lat: 42.591823, lng: -83.422243},
            {lat: 42.591869, lng: -83.422182},
            {lat: 42.59196, lng: -83.422182},
            {lat: 42.591994, lng: -83.422155},
            {lat: 42.59212, lng: -83.422058},
            {lat: 42.592235, lng: -83.422058},
            {lat: 42.59228, lng: -83.421965},
            {lat: 42.592783, lng: -83.421962},
            {lat: 42.593103, lng: -83.422059},
            {lat: 42.593286, lng: -83.422183},
            {lat: 42.593463, lng: -83.42217},
            {lat: 42.593547, lng: -83.422163},
            {lat: 42.593559, lng: -83.421928},
            {lat: 42.593834, lng: -83.42164},
            {lat: 42.595333, lng: -83.420074},
            {lat: 42.596743, lng: -83.419979},
            {lat: 42.596812, lng: -83.420646},
            {lat: 42.596793, lng: -83.422808},
            {lat: 42.597167, lng: -83.42288},
            {lat: 42.597343, lng: -83.422913},
            {lat: 42.598353, lng: -83.422701},
            {lat: 42.599111, lng: -83.422538},
            {lat: 42.599404, lng: -83.422609},
            {lat: 42.600025, lng: -83.422977},
            {lat: 42.600247, lng: -83.423118},
            {lat: 42.606383, lng: -83.422987},
        ];

        // Construct the polygon.
        districtBoundary = new google.maps.Polygon({
            paths: boundaryCoords,
            strokeColor: '#FF0000',
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: '#FF0000',
            fillOpacity: 0.35
        });
        districtBoundary.setMap(map);
        // Create the autocomplete object, restricting the search to geographical
        // location types.
        autocomplete = new google.maps.places.Autocomplete(
            /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
            {types: ['address']});

        // When the user selects an address from the dropdown, populate the address
        // fields in the form.
        autocomplete.addListener('place_changed', parseAddress);
        begin();
    }

    // Verify the provided address and check whether it falls
    // within the map boundaries.
    function parseAddress() {
        begin();
        // Get the place details from the autocomplete object.
        var place = autocomplete.getPlace();
        // If no street number is provided, ask for a valid address.
        if (place.address_components[0]["types"][0] !== "street_number") {
            outputLeft.innerHTML = '<img src="alert.png" alt="alert" width="50" class="alert"><span class="alert">Please provide a valid address.</span>';
            return;
        }
        outputLeft.innerHTML = '<span class="alert">Calculating...</span><img src="loading.gif" alt="loading" width="50" class="alert">';
        // Get each component of the address from the place details
        // and fill in the corresponding value.
        for (var i = 0; i < place.address_components.length; i++) {
            var addressType = place.address_components[i].types[0];
            if (componentForm.indexOf(addressType) > -1) {
                parsedAddress[addressType] = place.address_components[i];
            }
        }
        // Find out if the provided address is within the polygon.
        mapCheck = google.maps.geometry.poly.containsLocation(place.geometry.location, districtBoundary);

        dbCheck = undefined;
        marker.setMap(null);
        // Set the marker on the map.
        var image =
            mapCheck ?
                'flag_green.png' :
                'flag_red.png';

        marker = new google.maps.Marker({
            position: place.geometry.location,
            map: map,
            icon: image
        });
        map.panTo(place.geometry.location);
        parseFile();
    }

    // Bias the autocomplete object to the user's geographical location,
    // as supplied by the browser's 'navigator.geolocation' object.
    // noinspection JSUnusedGlobalSymbols
    function geolocate() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var geolocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                var circle = new google.maps.Circle({
                    center: geolocation,
                    radius: position.coords.accuracy
                });
                autocomplete.setBounds(circle.getBounds());
            });
        }
    }

    // Search an address component for a given term.
    function isIncluded(needle, haystack) {
        return haystack["long_name"].indexOf(needle) > -1 || haystack["short_name"].indexOf(needle) > -1;
    }


    // Parse the database file and determine whether the provided address is included.
    function parseFile() {
        Papa.parse("StreetDatabase.csv", {
            download: true,
            complete: function (results) {
                var data = results.data;
                var streetFound, school, notes, parsedMin, parsedMax, parsedList, parsedInput;
                // Output results of the map check.
                outputLeft.innerHTML = '<span class="alert">Map Check: </span><img ' + (mapCheck ? 'src="checked.png" alt="pass"' : 'src="cross.png" alt="fail"') + ' width="50" class="alert">' + (mobile ? "<br>" : "") + '<span class="alert"' + (mobile ? '' : ' style="padding-left:50px;"') + '>Database Check: </span>';
                // Go through each row on the database.
                for (var i = 1; i < data.length; i++) {
                    if (isIncluded(data[i][0], parsedAddress["route"]) && isIncluded(data[i][3], parsedAddress["postal_code"])) {
                        school = data[i][1];
                        notes = data[i][4];
                        parsedMin = parseInt(data[i][5]);
                        parsedMax = parseInt(data[i][6]);
                        if (data[i][7] === "")
                            parsedList = [];
                        else
                            parsedList = data[i][7].split(";");
                        parsedInput = {
                            long_name: parseInt(parsedAddress["street_number"]["long_name"]),
                            short_name: parseInt(parsedAddress["street_number"]["short_name"])
                        };

                        // The address lies within the boundaries if
                        // 1) there are no minimum or maximum values and there is no list of values.
                        // 2) the house number is within the minimum and maximum values.
                        // 3) the house number is included in the list of house numbers.
                        if (parsedList.length === 0 && ((isNaN(parsedMin) && isNaN(parsedMax)) || (parsedMin <= parsedInput["long_name"] && parsedInput["long_name"] <= parsedMax) || (parsedMin <= parsedInput["short_name"] && parsedInput["short_name"] <= parsedMax))) {
                            streetFound = true;
                            houseInside(school, notes);
                            break;
                        } else if (parsedList.length > 0) {
                            for (var k = 0; k < parsedList.length; k++) {
                                if (parsedList[k] == parsedInput["long_name"] || parsedList[k] == parsedInput["short_name"]) {
                                    streetFound = true;
                                    houseInside(school, notes);
                                    break;
                                }
                            }
                        }
                    }
                }
                if (!streetFound) {
                    houseNotFound();
                }
                // Determine whether both tests produced the same result.
                if (mapCheck !== dbCheck) {
                    outputRight.innerHTML += '<p style="color:red;">Conflicting information. Please call the district to confirm.</p>';
                }
                document.getElementById('reset').style.visibility = 'visible';

            }
        });
    }

    // Output appropriate information when the address is found in the database.
    function houseInside(school, notes) {
        // Clean up the school and put it in HTML format.
        var elem2, middle, high;
        if (school === "Doherty") {
            elem2 = "Sheiko Elementary School";
        } else if (school === "Roosevelt") {
            elem2 = "Roosevelt Elementary School";
        } else if (school === "Gretchko") {
            elem2 = "Scotch Elementary School";
        }
        school += " Elementary School";
        middle = "West Bloomfield Middle School";
        high = "West Bloomfield High School";
        school = "<ul><li>Grades PK-2: " + school + "</li><li>3-5: " + elem2 + "</li><li>6-8: " + middle + "</li><li>9-12: " + high + "</li></ul>";
        dbCheck = true;
        // Show any notes that exist.
        if (notes !== "")
            notes = '<p style="color:orange;">Notes: ' + notes + "</p>";
        outputLeft.innerHTML += '<img src="checked.png" alt="pass" width="50" class="alert">' + notes;
        outputRight.innerHTML = '<p id="result">Address ' + (mapCheck ? "confirmed" : "found in database") + '.</p>' + school;
    }

    // Output appropriate information if the address is not found in the database.
    function houseNotFound() {
        dbCheck = false;
        outputLeft.innerHTML += '<img src="cross.png" alt="fail" width="50" class="alert">';
        outputRight.innerHTML = '<p id="result">Address not in ' + (mapCheck ? "database" : "West Bloomfield School District") + ".</p>";
    }


</script>
<script src="https://maps.googleapis.com/maps/api/js?libraries=geometry,places&callback=initialize&key=AIzaSyBZo424j_xFmRXEPIacXI1oyyBbJohrCGQ"
        async defer></script>
<script src="papaparse.min.js"></script>
</body>
</html>
